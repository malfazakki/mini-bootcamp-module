# Materi 3.1: Menghubungkan ke Database (PostgreSQL)

## ðŸ—„ï¸ Kenapa Pakai Database?
Sebelumnya, kita menyimpan data di dalam **Array**. Masalahnya: jika server dimatikan atau di-restart, datanya **hilang**. 
**Database** menyimpan data di dalam harddisk sehingga permanen.

---

## ðŸ› ï¸ Langkah Integrasi (Node.js + PostgreSQL)

Untuk menghubungkan Node.js dengan PostgreSQL, kita butuh asisten bernama library `pg`.

### 1. Install Library
Di terminal, ketik:
```bash
npm install pg
```

### 2. Kode Koneksi Database
Buat file `db.js` atau tambahkan di atas `server.js`:

```javascript
const { Client } = require('pg');

// Informasi alamat database (Contoh)
const client = new Client({
  host: 'localhost',
  user: 'postgres',
  password: 'password_kamu',
  database: 'latihan_db',
  port: 5432,
});

client.connect()
  .then(() => console.log('Terhubung ke Database!'))
  .catch(err => console.error('Gagal konek:', err));

module.exports = client;
```

---

## ðŸ” Mengambil Data dari Database

Sekarang, ubah kode `app.get` kamu agar mengambil data dari tabel, bukan dari array:

```javascript
const db = require('./db.js'); // Ambil koneksi tadi

app.get("/pengeluaran", async (req, res) => {
    try {
        // Ambil data dari tabel bernama 'pengeluaran'
        const hasil = await db.query("SELECT * FROM pengeluaran");
        res.json(hasil.rows); // Kirim baris datanya saja
    } catch (err) {
        res.status(500).send("Error saat ambil data");
    }
});
```

---

## âœ… Latihan Praktik (Tugas)
1.  Ubah kode di `server.js` agar menggunakan koneksi database.
2.  Ganti variabel `let daftarPengeluaran = [...]` dengan perintah `db.query`.
3.  Buat tabel `pengeluaran` di PostgreSQL kamu dengan kolom `id`, `nama`, dan `nominal`.
4.  Coba jalankan dan lihat apakah datanya muncul.

---

**ðŸŽ“ Setelah Sesi Ini, Kamu Sudah Bisa:**
- âœ… Menghubungkan Server Node.js ke PostgreSQL.
- âœ… Melakukan perintah SQL `SELECT` lewat kode JavaScript.
- âœ… Menyimpan data secara permanen di database.
