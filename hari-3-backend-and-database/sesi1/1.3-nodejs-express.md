# Materi 1.3: Node.js & Express.js

## ğŸŸ¢ Apa itu Node.js?

**Node.js** adalah **runtime environment** yang memungkinkan JavaScript berjalan di luar browser (di server/komputer).

**ğŸ’¡ Analogi:**
- **Tanpa Node.js:** JavaScript hanya bisa jalan di browser (seperti ikan hanya bisa hidup di air)
- **Dengan Node.js:** JavaScript bisa jalan dimana saja! (ikan bisa hidup di darat juga ğŸ˜„)

**Kenapa Node.js?**
- âœ… Satu bahasa (JavaScript) untuk Frontend & Backend
- âœ… Cepat & scalable (event-driven, non-blocking I/O)
- âœ… NPM - package manager dengan 2 juta+ library
- âœ… Dipakai perusahaan besar: Netflix, Uber, NASA, PayPal

---

## âš¡ Apa itu Express.js?

**Express.js** adalah **framework** untuk Node.js yang membuat pembuatan web server & API jadi sangat mudah!

**ğŸ’¡ Analogi:**
- **Node.js** = Bahan mentah (tepung, telur, gula)
- **Express.js** = Resep & alat masak siap pakai (mixer, oven)

**Tanpa Express, kode Node.js murni:**
```javascript
const http = require('http');

const server = http.createServer((req, res) => {
    if (req.url === '/' && req.method === 'GET') {
        res.writeHead(200, { 'Content-Type': 'text/html' });
        res.end('<h1>Hello World</h1>');
    } else if (req.url === '/api/users' && req.method === 'GET') {
        res.writeHead(200, { 'Content-Type': 'application/json' });
        res.end(JSON.stringify({ users: [] }));
    }
    // ... routing manual untuk setiap endpoint ğŸ˜°
});

server.listen(3000);
```

**Dengan Express:**
```javascript
const express = require('express');
const app = express();

app.get('/', (req, res) => {
    res.send('<h1>Hello World</h1>');
});

app.get('/api/users', (req, res) => {
    res.json({ users: [] });
});

app.listen(3000);
```

**Lebih simpel, kan?** ğŸ‰

---

## ğŸ“¥ Install Node.js

### **Windows:**
1. Download dari: https://nodejs.org/
2. Pilih versi **LTS** (Long Term Support)
3. Install seperti aplikasi biasa
4. Restart terminal/VS Code

### **Cek Instalasi:**
```bash
node --version
# Output: v20.11.0 (atau versi terbaru)

npm --version
# Output: 10.2.4 (atau versi terbaru)
```

**ğŸ’¡ npm** (Node Package Manager) otomatis terinstall bersama Node.js.

---

## ğŸš€ Membuat Project Node.js Pertama

### **Step 1: Buat Folder Project**
```bash
mkdir my-first-server
cd my-first-server
```

### **Step 2: Inisialisasi npm**
```bash
npm init -y
```

**Hasil:** File `package.json` akan dibuat.

**`package.json`** adalah "blueprint" project Node.js yang berisi:
- Nama project
- Versi
- Dependencies (library yang dipakai)
- Scripts

**Contoh `package.json`:**
```json
{
  "name": "my-first-server",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC"
}
```

### **Step 3: Install Express**
```bash
npm install express
```

**Hasil:**
- Folder `node_modules` dibuat (berisi library Express & dependenciesnya)
- File `package-lock.json` dibuat (lock versi dependencies)
- Di `package.json`, muncul:
  ```json
  "dependencies": {
    "express": "^4.18.2"
  }
  ```

**âš ï¸ PENTING:** Jangan commit folder `node_modules` ke Git! Buat file `.gitignore`:
```
node_modules/
.env
```

---

## ğŸ¯ Server Pertama dengan Express

### **Buat file `index.js`:**

```javascript
// Import Express
const express = require('express');

// Inisialisasi aplikasi
const app = express();

// PORT
const PORT = 3000;

// Route pertama
app.get('/', (req, res) => {
    res.send('Halo dari Express!');
});

// Start server
app.listen(PORT, () => {
    console.log(`ğŸš€ Server berjalan di http://localhost:${PORT}`);
});
```

### **Jalankan Server:**
```bash
node index.js
```

**Output di terminal:**
```
ğŸš€ Server berjalan di http://localhost:3000
```

### **Buka Browser:**
```
http://localhost:3000
```

**Hasil:** Akan muncul teks "Halo dari Express!"

**ğŸ‰ SELAMAT! Server pertama Anda sudah jalan!**

---

## ğŸ›¤ï¸ Routing di Express

**Routing** = Menentukan bagaimana aplikasi merespon request ke endpoint tertentu.

### **Sintaks Dasar:**
```javascript
app.METHOD(PATH, HANDLER);
```

- **METHOD:** HTTP method (get, post, put, delete)
- **PATH:** URL path ('/users', '/products', dll)
- **HANDLER:** Function yang dijalankan (callback)

---

### **Contoh Routes:**

```javascript
const express = require('express');
const app = express();

// GET - Root
app.get('/', (req, res) => {
    res.send('Home Page');
});

// GET - About
app.get('/about', (req, res) => {
    res.send('About Page');
});

// GET - Contact
app.get('/contact', (req, res) => {
    res.send('Contact Page');
});

// GET - JSON Response
app.get('/api/hello', (req, res) => {
    res.json({
        message: 'Hello from API',
        timestamp: new Date()
    });
});

app.listen(3000, () => {
    console.log('Server running on port 3000');
});
```

**Test:**
- `http://localhost:3000/` â†’ "Home Page"
- `http://localhost:3000/about` â†’ "About Page"
- `http://localhost:3000/api/hello` â†’ JSON response

---

## ğŸ“¨ Request & Response Objects

### **Request Object (`req`)**

Berisi informasi tentang request dari client:

```javascript
app.get('/test', (req, res) => {
    console.log(req.method);        // 'GET'
    console.log(req.url);           // '/test'
    console.log(req.headers);       // Object berisi headers
    console.log(req.query);         // Query parameters
    console.log(req.params);        // URL parameters
    console.log(req.body);          // Body data (POST/PUT)
    
    res.send('Check your console!');
});
```

---

### **Response Object (`res`)**

Digunakan untuk mengirim response ke client:

```javascript
// Kirim text
res.send('Hello World');

// Kirim JSON
res.json({ message: 'Success', data: [] });

// Kirim HTML
res.send('<h1>Hello HTML</h1>');

// Set status code
res.status(404).send('Not Found');
res.status(201).json({ message: 'Created' });

// Redirect
res.redirect('/new-url');

// Send file
res.sendFile('/path/to/file.html');
```

---

## ğŸ”— Route Parameters

Mengambil data dari URL (dynamic segments).

```javascript
// Route dengan parameter
app.get('/users/:id', (req, res) => {
    const userId = req.params.id;
    res.json({ 
        message: `Getting user with ID: ${userId}`,
        userId: userId
    });
});

// Multiple parameters
app.get('/users/:userId/posts/:postId', (req, res) => {
    const { userId, postId } = req.params;
    res.json({ userId, postId });
});
```

**Test:**
- `GET /users/123` â†’ userId = "123"
- `GET /users/789/posts/456` â†’ userId = "789", postId = "456"

---

## â“ Query Parameters

Data yang dikirim via URL setelah `?`.

```javascript
app.get('/search', (req, res) => {
    const { q, category, limit } = req.query;
    
    res.json({
        searchQuery: q,
        category: category,
        limit: limit
    });
});
```

**Test:**
```
GET /search?q=laptop&category=electronics&limit=10

Response:
{
    "searchQuery": "laptop",
    "category": "electronics",
    "limit": "10"
}
```

---

## ğŸ“¦ Middleware `express.json()`

Untuk bisa membaca JSON dari request body (POST/PUT).

```javascript
const express = require('express');
const app = express();

// WAJIB! Agar bisa baca req.body
app.use(express.json());

app.post('/api/users', (req, res) => {
    const { name, email } = req.body;
    
    res.json({
        message: 'User created',
        data: { name, email }
    });
});

app.listen(3000);
```

**Test dengan Postman:**
```
POST http://localhost:3000/api/users
Body (JSON):
{
    "name": "Budi",
    "email": "budi@email.com"
}
```

---

## ğŸ¨ Contoh Lengkap: Simple API

```javascript
const express = require('express');
const app = express();
const PORT = 3000;

// Middleware
app.use(express.json());

// Data sementara (nanti diganti database)
let users = [
    { id: 1, name: 'Budi', email: 'budi@email.com' },
    { id: 2, name: 'Ani', email: 'ani@email.com' }
];

// GET semua users
app.get('/api/users', (req, res) => {
    res.json({
        success: true,
        data: users
    });
});

// GET user by ID
app.get('/api/users/:id', (req, res) => {
    const id = parseInt(req.params.id);
    const user = users.find(u => u.id === id);
    
    if (!user) {
        return res.status(404).json({
            success: false,
            message: 'User not found'
        });
    }
    
    res.json({
        success: true,
        data: user
    });
});

// POST create user
app.post('/api/users', (req, res) => {
    const { name, email } = req.body;
    
    const newUser = {
        id: users.length + 1,
        name,
        email
    };
    
    users.push(newUser);
    
    res.status(201).json({
        success: true,
        message: 'User created',
        data: newUser
    });
});

// DELETE user
app.delete('/api/users/:id', (req, res) => {
    const id = parseInt(req.params.id);
    const index = users.findIndex(u => u.id === id);
    
    if (index === -1) {
        return res.status(404).json({
            success: false,
            message: 'User not found'
        });
    }
    
    users.splice(index, 1);
    
    res.json({
        success: true,
        message: 'User deleted'
    });
});

// Start server
app.listen(PORT, () => {
    console.log(`ğŸš€ Server running on http://localhost:${PORT}`);
});
```

**Test semua endpoints dengan Postman!**

---

## ğŸ”„ Nodemon (Auto-Restart Server)

**Masalah:** Setiap kali edit code, harus restart server manual (Ctrl+C, lalu `node index.js` lagi).

**Solusi:** **Nodemon** - auto-restart saat file berubah!

### **Install Nodemon:**
```bash
npm install --save-dev nodemon
```

### **Update `package.json`:**
```json
{
  "scripts": {
    "start": "node index.js",
    "dev": "nodemon index.js"
  }
}
```

### **Jalankan:**
```bash
npm run dev
```

**Sekarang, setiap kali save file, server otomatis restart!** ğŸ‰

---

## ğŸ“ Struktur Project yang Baik

```
my-api/
â”‚
â”œâ”€â”€ node_modules/       # Dependencies (jangan commit)
â”œâ”€â”€ routes/             # File routes terpisah
â”‚   â”œâ”€â”€ users.js
â”‚   â””â”€â”€ products.js
â”œâ”€â”€ controllers/        # Logic handler
â”‚   â”œâ”€â”€ userController.js
â”‚   â””â”€â”€ productController.js
â”œâ”€â”€ models/             # Database models
â”œâ”€â”€ middleware/         # Custom middleware
â”œâ”€â”€ .env                # Environment variables
â”œâ”€â”€ .gitignore
â”œâ”€â”€ package.json
â”œâ”€â”€ package-lock.json
â””â”€â”€ server.js           # Entry point
```

**Akan dipelajari lebih lanjut nanti!**

---

## âœ… Latihan Praktik

**Latihan 1:** Buat server Express dengan routes:
```
GET  /              â†’ "Welcome to My API"
GET  /api/products  â†’ Array produk (dummy data)
GET  /api/products/:id â†’ Detail produk
POST /api/products  â†’ Create produk baru
```

**Latihan 2:** Install Nodemon dan setup script `npm run dev`.

**Latihan 3:** Buat endpoint:
```
GET /api/hello?name=Budi  
â†’ Response: "Hello, Budi!"
```

---

## ğŸ¯ Yang Harus Dikuasai:

- âœ… Install Node.js & npm
- âœ… `npm init` dan `package.json`
- âœ… Install Express (`npm install express`)
- âœ… Buat server sederhana
- âœ… Routing (GET, POST, PUT, DELETE)
- âœ… Request & Response objects
- âœ… Route parameters (`/:id`)
- âœ… Query parameters (`?key=value`)
- âœ… Middleware `express.json()`
- âœ… Nodemon untuk development

---

**ğŸ’¡ Tips:**
- Gunakan **Nodemon** saat development
- Gunakan **Postman** untuk test API
- **req.params** untuk dynamic URL segments
- **req.query** untuk filter/search
- **req.body** untuk data POST/PUT (jangan lupa `express.json()`!)
- Status code penting: `201` (created), `404` (not found), `400` (bad request)

**ğŸŠ Next:** Kita akan buat CRUD API lengkap dan hubungkan ke database PostgreSQL! ğŸš€
