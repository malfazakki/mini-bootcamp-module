# Materi 1.1: Integrasi Frontend & Backend

## üîó Bagaimana Frontend & Backend Berkomunikasi?

Frontend (Browser) dan Backend (Server) berkomunikasi melalui **HTTP requests & responses**.

**üí° Analogi Restaurant:**
```
Customer (Frontend)  ‚Üí  Pesanan (Request)  ‚Üí  Chef (Backend)
Customer (Frontend)  ‚Üê  Makanan (Response)  ‚Üê  Chef (Backend)
```

---

## üåê Arsitektur Full-Stack Application

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ          FRONTEND (Browser)              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  HTML, CSS, JavaScript             ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  - User Interface                   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  - User Interactions                ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  - Fetch API untuk request          ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
              ‚îÇ  HTTP Request/Response
              ‚îÇ  (JSON)
              ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         BACKEND (Server)                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  Node.js + Express                 ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  - REST API Endpoints              ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  - Business Logic                   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  - Authentication                   ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
              ‚îÇ  SQL Queries
              ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         DATABASE (PostgreSQL)            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  Data Storage                      ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  - Users, Products, Orders, etc    ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîÑ Flow Data End-to-End

### **Contoh: User Menambahkan Todo Baru**

#### **1. Frontend - User Action**
```javascript
// User mengisi form dan klik "Add"
const newTodo = {
    title: "Belajar Fullstack"
};
```

#### **2. Frontend - Send Request**
```javascript
fetch('http://localhost:3000/api/todos', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify(newTodo)
})
.then(res => res.json())
.then(data => {
    console.log('Todo created:', data);
    // Update UI dengan data baru
});
```

#### **3. Backend - Receive & Process**
```javascript
app.post('/api/todos', async (req, res) => {
    const { title } = req.body;
    
    // Validasi
    if (!title) {
        return res.status(400).json({ error: 'Title required' });
    }
    
    // Simpan ke database
    const result = await db.query(
        'INSERT INTO todos (title) VALUES ($1) RETURNING *',
        [title]
    );
    
    // Send response
    res.status(201).json({
        success: true,
        data: result.rows[0]
    });
});
```

#### **4. Database - Store Data**
```sql
INSERT INTO todos (title) VALUES ('Belajar Fullstack')
RETURNING *;
```

#### **5. Backend - Send Response**
```json
{
    "success": true,
    "data": {
        "id": 123,
        "title": "Belajar Fullstack",
        "completed": false,
        "created_at": "2026-01-20T12:00:00.000Z"
    }
}
```

#### **6. Frontend - Update UI**
```javascript
.then(data => {
    // Tambahkan todo baru ke tampilan
    const todoHTML = `
        <div class="todo-item">
            <span>${data.data.title}</span>
            <button onclick="deleteTodo(${data.data.id})">Delete</button>
        </div>
    `;
    document.getElementById('todoList').innerHTML += todoHTML;
});
```

---

## üö´ CORS (Cross-Origin Resource Sharing)

### **Apa itu CORS?**

**CORS** adalah mekanisme keamanan browser yang **membatasi** request ke domain berbeda.

**Masalah:**
```
Frontend: http://localhost:5500  (Live Server)
Backend:  http://localhost:3000  (Express)

‚ùå Browser block request karena beda port (origin berbeda)!
```

**Error di Console:**
```
Access to fetch at 'http://localhost:3000/api/todos' from origin 
'http://localhost:5500' has been blocked by CORS policy
```

---

### **Solusi: Install & Setup CORS**

#### **1. Install CORS Middleware**
```bash
npm install cors
```

#### **2. Tambahkan di Server**
```javascript
const express = require('express');
const cors = require('cors');

const app = express();

// Enable CORS untuk semua origins (development)
app.use(cors());

// Atau, enable untuk origin tertentu (production)
app.use(cors({
    origin: 'https://mywebsite.com',
    credentials: true
}));

app.use(express.json());

// ... routes
```

**Sekarang Frontend bisa request ke Backend!** ‚úÖ

---

## üéØ Integrasi Frontend dengan Backend

### **Project Structure:**

```
fullstack-todo-app/
‚îÇ
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ style.css
‚îÇ   ‚îî‚îÄ‚îÄ script.js
‚îÇ
‚îî‚îÄ‚îÄ backend/
    ‚îú‚îÄ‚îÄ server.js
    ‚îú‚îÄ‚îÄ db.js
    ‚îú‚îÄ‚îÄ .env
    ‚îú‚îÄ‚îÄ package.json
    ‚îî‚îÄ‚îÄ node_modules/
```

---

### **Backend: `server.js`**

```javascript
const express = require('express');
const cors = require('cors');
const db = require('./db');
require('dotenv').config();

const app = express();
const PORT = process.env.PORT || 3000;

// Middleware
app.use(cors());
app.use(express.json());

// GET all todos
app.get('/api/todos', async (req, res) => {
    try {
        const result = await db.query('SELECT * FROM todos ORDER BY created_at DESC');
        res.json({
            success: true,
            data: result.rows
        });
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

// POST create todo
app.post('/api/todos', async (req, res) => {
    try {
        const { title } = req.body;
        
        if (!title) {
            return res.status(400).json({ success: false, error: 'Title required' });
        }
        
        const result = await db.query(
            'INSERT INTO todos (title) VALUES ($1) RETURNING *',
            [title]
        );
        
        res.status(201).json({
            success: true,
            data: result.rows[0]
        });
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

// DELETE todo
app.delete('/api/todos/:id', async (req, res) => {
    try {
        const { id } = req.params;
        
        const result = await db.query(
            'DELETE FROM todos WHERE id = $1 RETURNING *',
            [id]
        );
        
        if (result.rows.length === 0) {
            return res.status(404).json({ success: false, error: 'Todo not found' });
        }
        
        res.json({
            success: true,
            message: 'Todo deleted'
        });
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

app.listen(PORT, () => {
    console.log(`üöÄ Backend running on http://localhost:${PORT}`);
});
```

---

### **Frontend: `index.html`**

```html
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fullstack Todo App</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>üìù Fullstack Todo App</h1>
        
        <!-- Form -->
        <div class="form-container">
            <input type="text" id="todoInput" placeholder="What needs to be done?">
            <button id="addBtn">Add Todo</button>
        </div>
        
        <!-- Loading -->
        <div id="loading" class="hidden">Loading...</div>
        
        <!-- Todo List -->
        <div id="todoList"></div>
    </div>
    
    <script src="script.js"></script>
</body>
</html>
```

---

### **Frontend: `script.js`**

```javascript
// API Base URL
const API_URL = 'http://localhost:3000/api/todos';

// Elements
const todoInput = document.getElementById('todoInput');
const addBtn = document.getElementById('addBtn');
const todoList = document.getElementById('todoList');
const loading = document.getElementById('loading');

// Load todos saat halaman dibuka
window.addEventListener('DOMContentLoaded', loadTodos);

// Add todo
addBtn.addEventListener('click', addTodo);
todoInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        addTodo();
    }
});

// ========== FUNCTIONS ==========

async function loadTodos() {
    try {
        showLoading();
        
        const response = await fetch(API_URL);
        const result = await response.json();
        
        if (result.success) {
            renderTodos(result.data);
        } else {
            alert('Failed to load todos');
        }
        
    } catch (error) {
        console.error('Error loading todos:', error);
        alert('Error loading todos. Make sure backend is running!');
    } finally {
        hideLoading();
    }
}

async function addTodo() {
    const title = todoInput.value.trim();
    
    if (title === '') {
        alert('Please enter a todo');
        return;
    }
    
    try {
        showLoading();
        
        const response = await fetch(API_URL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ title })
        });
        
        const result = await response.json();
        
        if (result.success) {
            todoInput.value = '';
            loadTodos();  // Reload list
        } else {
            alert('Failed to add todo');
        }
        
    } catch (error) {
        console.error('Error adding todo:', error);
        alert('Error adding todo');
    } finally {
        hideLoading();
    }
}

async function deleteTodo(id) {
    if (!confirm('Delete this todo?')) {
        return;
    }
    
    try {
        showLoading();
        
        const response = await fetch(`${API_URL}/${id}`, {
            method: 'DELETE'
        });
        
        const result = await response.json();
        
        if (result.success) {
            loadTodos();  // Reload list
        } else {
            alert('Failed to delete todo');
        }
        
    } catch (error) {
        console.error('Error deleting todo:', error);
        alert('Error deleting todo');
    } finally {
        hideLoading();
    }
}

function renderTodos(todos) {
    if (todos.length === 0) {
        todoList.innerHTML = '<p class="empty">No todos yet. Add one above!</p>';
        return;
    }
    
    todoList.innerHTML = todos.map(todo => `
        <div class="todo-item">
            <span>${todo.title}</span>
            <button onclick="deleteTodo(${todo.id})" class="delete-btn">Delete</button>
        </div>
    `).join('');
}

function showLoading() {
    loading.classList.remove('hidden');
}

function hideLoading() {
    loading.classList.add('hidden');
}
```

---

### **Frontend: `style.css`**

```css
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 20px;
}

.container {
    max-width: 600px;
    margin: 0 auto;
}

h1 {
    text-align: center;
    color: white;
    margin-bottom: 30px;
}

.form-container {
    background: white;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
    display: flex;
    gap: 10px;
}

#todoInput {
    flex: 1;
    padding: 12px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 16px;
}

#addBtn {
    padding: 12px 24px;
    background: #667eea;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
}

#addBtn:hover {
    background: #5568d3;
}

#loading {
    text-align: center;
    color: white;
    margin: 20px 0;
}

.hidden {
    display: none;
}

#todoList {
    background: white;
    padding: 20px;
    border-radius: 10px;
}

.todo-item {
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
    margin-bottom: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.delete-btn {
    background: #e74c3c;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 5px;
    cursor: pointer;
}

.delete-btn:hover {
    background: #c0392b;
}

.empty {
    text-align: center;
    color: #999;
    padding: 40px;
}
```

---

## üß™ Testing Integrasi

### **Step 1: Jalankan Backend**
```bash
cd backend
npm run dev
```

**Output:**
```
üöÄ Backend running on http://localhost:3000
‚úÖ Connected to PostgreSQL database
```

### **Step 2: Buka Frontend**
```bash
cd frontend
# Buka index.html dengan Live Server
```

### **Step 3: Test!**
- Tambah todo ‚Üí Cek apakah muncul
- Delete todo ‚Üí Cek apakah hilang
- Refresh halaman ‚Üí Data tetap ada (karena dari database)

---

## ‚úÖ Checklist Integrasi Berhasil

- [ ] Backend running tanpa error
- [ ] Database connected
- [ ] CORS enabled
- [ ] Frontend bisa fetch data
- [ ] Create todo bekerja
- [ ] Delete todo bekerja
- [ ] Data persistent (tidak hilang saat refresh)

---

## üéØ Yang Harus Dikuasai:

- ‚úÖ Konsep Client-Server communication
- ‚úÖ Fetch API (GET, POST, DELETE)
- ‚úÖ Async/await & Promises
- ‚úÖ CORS dan cara mengatasinya
- ‚úÖ Error handling di Frontend & Backend
- ‚úÖ Loading states
- ‚úÖ End-to-end data flow

---

**üí° Tips:**
- Selalu **jalankan backend dulu** sebelum test frontend
- Gunakan **console.log** untuk debugging
- **Test di Postman dulu** untuk memastikan API bekerja
- **Error handling** di frontend & backend penting!
- Gunakan **try-catch** untuk fetch requests üöÄ

**üéä Next:** Kita akan belajar deployment ke cloud!
